import{d as D,a3 as F,h as C,y as h,l as R,a4 as z,o as y,c as X,m as $,r as I,n as B,Q as H,e as W,U as V}from"./framework.B_s5zxe9.js";const O={type:{type:String,default:"hover"},minBarSize:{type:Number,default:50},scrollTop:{type:Number,default:0},scrollLeft:{type:Number,default:0},offsetLeft:{type:Number,default:0},offsetRight:{type:Number,default:10},offsetTop:{type:Number,default:0},offsetBottom:{type:Number,default:10},isAutoUpdate:{type:Boolean,default:!0},dragSpeedX:{type:Number,default:1},dragSpeedY:{type:Number,default:1}},x=(n,a,f,e,l)=>(n-a)/(a-f-e-l),N=(n,a,f,e,l)=>{const i=n-(a-n)-f-e;return i<l?l:i},Q={name:"LScrollBar"},G=D({...Q,props:O,emits:["scroll"],setup(n,{expose:a,emit:f}){const e=n,l=F({scrollWidth:0,scrollHeight:0,scrollContentWidth:0,scrollContentHeight:0,scrollBarY:{height:0,top:e.offsetTop,clientY:null,multiple:1,scrollTop:0},scrollBarX:{width:0,left:e.offsetLeft,clientX:null,multiple:1,scrollLeft:0}});let i=!1,Y=null,L=null,T=null;const g=C(),r=C(),A=()=>{l.scrollWidth=r.value.offsetWidth,l.scrollHeight=r.value.offsetHeight,l.scrollContentWidth=r.value.scrollWidth,l.scrollContentHeight=r.value.scrollHeight},u=()=>{const{scrollContentWidth:t,scrollWidth:o,scrollContentHeight:s,scrollHeight:c}=l;t>o&&(l.scrollBarX.width=N(o,t,e.offsetLeft,e.offsetRight,e.minBarSize),l.scrollBarX.multiple=x(t,o,l.scrollBarX.width,e.offsetLeft,e.offsetRight)),s>c&&(l.scrollBarY.height=N(c,s,e.offsetTop,e.offsetBottom,e.minBarSize),l.scrollBarY.multiple=x(s,c,l.scrollBarY.height,e.offsetTop,e.offsetBottom))};function d(t=!0){const o=r.value.scrollLeft,s=e.offsetLeft+o/l.scrollBarX.multiple,c=g.value.querySelector(".agile-scroll-bar-x");c&&(c.style.transform=`translateX(${s}px)`),t&&(L=requestAnimationFrame(()=>{d()}))}function p(t=!0){const o=r.value.scrollTop,s=e.offsetTop+o/l.scrollBarY.multiple,c=g.value.querySelector(".agile-scroll-bar-y");c&&(c.style.transform=`translateY(${s}px)`),t&&(T=requestAnimationFrame(()=>{p()}))}const v=()=>{A(),e.type!=="hide"&&(u(),V(()=>{d(!1),p(!1)}))},E=t=>{e.type!=="hide"&&(i||(d(),p(),i=!0),clearTimeout(Y),Y=setTimeout(()=>{cancelAnimationFrame(L),cancelAnimationFrame(T),i=!1},500)),f("scroll",{scrollTop:r.value.scrollTop,scrollLeft:r.value.scrollLeft,scrollWidth:l.scrollWidth,scrollHeight:l.scrollHeight,scrollContentWidth:l.scrollContentWidth,scrollContentHeight:l.scrollContentHeight},t)},b=(t,o)=>{o==="scrollBarX"&&(l.scrollBarX.clientX=t.clientX,l.scrollBarX.scrollLeft=r.value.scrollLeft),o==="scrollBarY"&&(l.scrollBarY.clientY=t.clientY,l.scrollBarY.scrollTop=r.value.scrollTop),window.addEventListener("mousemove",w)};function w(t){const o=l.scrollBarX.clientX,s=l.scrollBarY.clientY;if(o){let c=t.clientX-o;r.value.scrollLeft=l.scrollBarX.scrollLeft+c*(l.scrollBarX.multiple*e.dragSpeedX)}if(s){let c=t.clientY-s;r.value.scrollTop=l.scrollBarY.scrollTop+c*l.scrollBarY.multiple*e.dragSpeedY}}function U(){l.scrollBarX.clientX=null,l.scrollBarY.clientY=null,window.removeEventListener("mousemove",w)}function S(){window.addEventListener("mouseup",U)}function k(){window.removeEventListener("mouseup",S)}function q(t){t>=0&&(r.value.scrollLeft=t)}function _(t){t>=0&&(r.value.scrollTop=t)}let m=null;const M=()=>{let t=null;m=new MutationObserver(()=>{clearTimeout(t),t=setTimeout(()=>{v()},200)}),m.observe(r.value,{attributes:!0,childList:!0,subtree:!0})};return h(()=>e.offsetLeft,()=>{u(),d(!1)}),h(()=>e.offsetRight,()=>{u()}),h(()=>e.offsetTop,()=>{u(),p(!1)}),h(()=>e.offsetBottom,()=>{u()}),R(()=>{v(),S(),e.isAutoUpdate&&M()}),z(()=>{k(),e.isAutoUpdate&&m&&m.disconnect()}),a({updated:v,setScrollLeft:q,setScrollTop:_}),(t,o)=>(y(),X("div",{ref_key:"scrollBox",ref:g,class:B(["agile-scrollbar",{"not-user-select":l.scrollBarX.clientX||l.scrollBarY.clientY,"scrollbar-hover":e.type==="hover","scrollbar-hide":e.type==="hide"}])},[$("div",{ref_key:"scroll",ref:r,class:B(["agile-scroll",{"scroll-x":l.scrollContentWidth>l.scrollWidth,"scroll-y":l.scrollContentHeight>l.scrollHeight}]),onScroll:E},[I(t.$slots,"default")],34),l.scrollContentWidth>l.scrollWidth?(y(),X("div",{key:0,class:B(["agile-scroll-bar-x",{act:l.scrollBarX.clientX}]),style:H({width:l.scrollBarX.width+"px"}),onMousedown:o[0]||(o[0]=s=>b(s,"scrollBarX"))},null,38)):W("",!0),l.scrollContentHeight>l.scrollHeight?(y(),X("div",{key:1,class:B(["agile-scroll-bar-y",{act:l.scrollBarY.clientY}]),style:H({height:l.scrollBarY.height+"px"}),onMousedown:o[1]||(o[1]=s=>b(s,"scrollBarY"))},null,38)):W("",!0)],2))}});export{G as _};
